<project name="embed-test" default="main" basedir=".">
  <property name="ant.src" location="../.."/>
        
  <import file="build.xml"/>

  <target name="main">
     <property name="junit.jar" location="${base.path}/junit3.7/junit.jar"/>
     <echo>${junit.jar} ${velocity.jar}</echo>

    <path id="myJars" >
      <pathelement path="${junit.jar}" />
      <pathelement path="${jxpath.jar}" />
      <pathelement path="${velocity-dep.jar}" />
      <pathelement path="${velocity.jar}" />
      <pathelement path="${jexl.jar}" />
      <pathelement path="${commons-discovery.jar}" />
      <pathelement path="${commons-logging.jar}" />
      <pathelement path="${ant.home}/lib/ant-sax2.jar" />
    </path>

    <systemPath pathRef="myJars"/>

    <junit id="replacedJunit" />
  
    <echo message="toString sample: ${toString:replacedJunit}" />
 
    <!-- This is Taksdef2.java - it'll use the systemPath as parent loader
      -->
    <taskdef classname="org.apache.tools.ant.taskdefs.optional.JXPath"
             name="jxpath" />
    <taskdef classname="org.apache.tools.ant.taskdefs.optional.JXPathSet"
             name="jxpathSet" />
    <taskdef classname="org.apache.tools.ant.taskdefs.optional.VelocityProperties"
             name="velocityProperties" />
    <taskdef classname="org.apache.tools.ant.taskdefs.optional.JexlProperties"
             name="jexlProperties" />

    <!-- Init JxPath. '/' is the project -->
    <jxpath/>
    <velocityProperties/>
    <jexlProperties/>

    <echo message="vel /references/myJars: ${vm:$ant.references.myJars}" />

    <echo message="jexl /references/myJars: ${jexl:ant.references.myJars}" />

    <echo message="jxPath /targets[1]: ${jxpath:/targets[1]}" />
    <echo message="jxPath /references: ${jxpath:/references}" />
    <echo message="jxPath /references[@name='myJars']: ${jxpath:/references[@name='myJars']}" />
    <echo message="jxPath /references/myJars: ${jxpath:/references/myJars}" />

    <!-- This is XMLDOM.java - a datatype that holds an xml DOM  -->
    <typedef name="xmldom" classname="org.apache.tools.ant.types.XMLDOM"/>

    <!-- Init XMLDOM. The DOM of file test.xml will be referenced via the id-->
    <xmldom id="test.xml" file="test.xml"/>  

    <echo message="XMLDOM: ${jxpath:/references/test.xml/root/project/@name}" />

    
  </target>


  <target name="test-import" >
    <antcall target="embed.main" />
  </target>


</project>
