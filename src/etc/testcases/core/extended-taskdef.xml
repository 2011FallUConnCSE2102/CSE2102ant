<project name="extended-taskdef" default="testRun">

  <description>
    Try and replicate a reported problem.

  </description>
  <property name="src" value="Foo.java"/>

  <target name="write" >
    <echo file="${src}">
      import org.apache.tools.ant.BuildException;

      public class Foo extends org.apache.tools.ant.taskdefs.WaitFor {

        public void execute() {
          throw  new BuildException("executing the Foo task");
        }
      }
    </echo>
  </target>

  <target name="compile" depends="write">
    <javac srcdir="${basedir}" includes="${src}"/>
  </target>

  <target name="testRun" depends="compile">
    <taskdef name="foo" classname="Foo"
        classpath="${basedir}"/>
    <foo maxwait="5" maxwaitunit="second"
        timeoutproperty="foo">
      <or/>
    </foo>
  </target>

  <target name="teardown">
    <delete>
      <fileset dir="${basedir}"
          includes="${src},*.class"/>
    </delete>
  </target>

</project>