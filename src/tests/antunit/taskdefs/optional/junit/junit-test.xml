<project default="all" xmlns:au="antlib:org.apache.ant.antunit">
  <property name="ant-build" location="../../../../../../build"/>
  <property name="build-junit-dir" location="${ant-build}/ant-unit/junit-dir"/>
  <property name="classes.dir" location="${build-junit-dir}/classes"/>
  <property name="reports.dir" location="${build-junit-dir}/report"/>
  

  <target name="init">
    <delete quiet="yes" dir="${build-junit-dir}"/>
    <mkdir  dir="${classes.dir}"/>
    <mkdir  dir="${reports.dir}"/>
  </target>
    
  <target name="compile" depends="init">
    <javac srcdir="src" destdir="${classes.dir}" debug="yes"/>
  </target>

  <target name="test-junit-show-output-yes" depends="compile">
    <junit fork="yes" haltonfailure="no" showoutput="yes"
           outputtoformatters="no">
      <test name="ExampleTest" todir="${reports.dir}"/> 
      <classpath path="${classes.dir}"/>
      <formatter type="plain" usefile="yes"/>
    </junit>
    <au:assertLogContains text="Hello From Test" />
    <au:assertFalse>
      <isfileselected file="${reports.dir}/TEST-ExampleTest.txt">
        <contains text="Hello From Test"/>
      </isfileselected>
    </au:assertFalse>
  </target>

  <target name="test-junit-show-output-no" depends="compile">
    <junit fork="yes" haltonfailure="no" showoutput="no"
           outputtoformatters="no">
      <test name="ExampleTest" todir="${reports.dir}"/> 
      <classpath path="${classes.dir}"/>
      <formatter type="plain" usefile="yes"/>
    </junit>
    <au:assertLogDoesntContain text="Hello From Test" />
    <au:assertFalse>
      <isfileselected file="${reports.dir}/TEST-ExampleTest.txt">
        <contains text="Hello From Test"/>
      </isfileselected>
    </au:assertFalse>
  </target>

  <target name="all">
    <au:antunit>
      <fileset file="${ant.file}"/>
      <au:plainlistener/>
    </au:antunit>
  </target>

</project>

